openapi: 3.0.3
info:
  title: Payment Processing API
  description: This API handles various types of payment requests and responses including Pix, PSE, and OXXO payment methods.
  version: 1.0.0
servers:
  - url: 'https://sandbox.ebanxpay.com/'
    description: Sandbox API Server
  - url: 'https://api.ebanxpay.com/'
    description: Production API Server
paths:
  /ws/direct:
    post:
      summary: Process a payment
      description: Processes payment requests and returns the corresponding responses for Pix, PSE, and OXXO payment methods.
      requestBody:
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/PixBRRequest'
                - $ref: '#/components/schemas/PSECORequest'
                - $ref: '#/components/schemas/OXXOMXRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PixBRResponse'
                  - $ref: '#/components/schemas/PSECOResponse'
                  - $ref: '#/components/schemas/OXXOMXResponse'
                  - $ref: '#/components/schemas/ErrorResponse'

components:
  
  schemas:
  
    PixBRRequest:
      type: object
      title: Pix Payment Request
      description: Request payload to initiate a Pix payment.
      properties:
        integration_key:
          type: string
          description: "Unique key for integration with the payment provider."
          example: "dummy_integration_key_12345"
        operation:
          type: string
          description: "Type of operation, e.g., 'request'."
          example: "request"
        mode:
          type: string
          description: "Mode of the request, e.g., 'full'."
          example: "full"
        payment:
          type: object
          description: "Payment details."
          properties:
            name:
              type: string
              description: "Full name of the payer."
              example: "John Doe"
            email:
              type: string
              description: "Email address of the payer."
              example: "john.doe@example.com"
            document:
              type: string
              description: "Document number of the payer (e.g., CPF in Brazil)."
              example: "12345678900"
            address:
              type: string
              description: "Street address of the payer."
              example: "123 Elm Street"
            street_number:
              type: string
              description: "Street number of the payer's address."
              example: "123"
            city:
              type: string
              description: "City of the payer's address."
              example: "São Paulo"
            state:
              type: string
              description: "State of the payer's address."
              example: "SP"
            zipcode:
              type: string
              description: "ZIP code of the payer's address."
              example: "01000-000"
            country:
              type: string
              description: "Country code of the payer's address."
              example: "BR"
            phone_number:
              type: string
              description: "Phone number of the payer."
              example: "+55 11 98765-4321"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'pix'."
              example: "pix"
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "12345678901234567890123456"
            currency_code:
              type: string
              description: "Currency code, e.g., 'BRL'."
              example: "BRL"
            amount_total:
              type: string
              description: "Total amount for the payment."
              example: "100.00"
            redirect_url:
              type: string
              description: "URL to redirect the user after payment."
              example: "https://example.com/redirect"
            notification_url:
              type: string
              description: "URL for payment notifications."
              example: "https://example.com/notify"
            note:
              type: string
              description: "Additional notes for the payment."
              example: "Payment for services"
            split:
              type: array
              items:
                type: object
                properties:
                  recipient_code:
                    type: string
                    description: "Code of the recipient for split payments."
                    example: "RECIPIENT-123"
                  amount:
                    type: string
                    description: "Amount allocated to the recipient."
                    example: "100.00"
                  liable:
                    type: boolean
                    description: "Indicates if the recipient is liable for the payment."
                    example: true
                  charge_fee:
                    type: boolean
                    description: "Indicates if the recipient should bear the transaction fee."
                    example: true
            expiration_time_in_seconds:
              type: integer
              description: "Time in seconds until the payment expires."
              example: 3600
        metadata:
          type: object
          description: "Additional metadata related to the payment."
          properties:
            risk:
              type: object
              properties:
                loyal_customer:
                  type: boolean
                  description: "Indicates if the payer is a loyal customer."
                  example: true

    PixBRResponse:
      type: object
      title: Pix Payment Response
      description: Response payload for a Pix payment request.
      properties:
        payment:
          type: object
          description: "Details of the processed payment."
          properties:
            hash:
              type: string
              description: "Unique identifier for the payment."
              example: "dummy_hash_123456"
            country:
              type: string
              description: "Country code of the payment."
              example: "br"
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "12345678901234567890123456"
            order_number:
              type: string
              description: "Order number associated with the payment."
              example: "ORD123456"
            status:
              type: string
              description: "Payment status, e.g., 'PE' (Pending)."
              example: "PE"
            status_date:
              type: string
              format: date-time
              description: "Date and time of the payment status."
              example: "2024-09-16T10:23:41Z"
            open_date:
              type: string
              format: date-time
              description: "Date and time when the payment was opened."
              example: "2024-09-16T10:23:41Z"
            confirm_date:
              type: string
              format: date-time
              description: "Date and time when the payment was confirmed."
              example: null
            transfer_date:
              type: string
              format: date-time
              description: "Date and time when the payment was transferred."
              example: null
            amount_br:
              type: string
              description: "Amount in the local currency (BRL)."
              example: "100.00"
            amount_ext:
              type: string
              description: "Amount in the external currency."
              example: "100.00"
            amount_iof:
              type: string
              description: "Amount of IOF (tax) applied to the payment."
              example: "0.00"
            currency_rate:
              type: string
              description: "Currency exchange rate used."
              example: "1.0000"
            currency_ext:
              type: string
              description: "External currency code."
              example: "BRL"
            due_date:
              type: string
              format: date
              description: "Due date for the payment."
              example: "2024-09-16"
            instalments:
              type: string
              description: "Number of payment instalments."
              example: "1"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'pix'."
              example: "pix"
            redirect_url:
              type: string
              description: "URL to redirect the user after payment."
              example: "https://example.com/redirect?hash=dummy_hash_123456"
            pre_approved:
              type: boolean
              description: "Indicates if the payment is pre-approved."
              example: false
            capture_available:
              type: string
              description: "Indicates if the payment can be captured."
              example: null
            note:
              type: string
              description: "Additional notes for the payment."
              example: "Payment for services"
            pix:
              type: object
              properties:
                qr_code_value:
                  type: string
                  description: "QR code value for Pix payment."
                  example: "00020101021226740014br.gov.bcb.pix2552pix.example.com/qr/v2/dummyqr123456"
            split:
              type: array
              items:
                type: object
                properties:
                  recipient_code:
                    type: string
                    description: "Code of the recipient for split payments."
                    example: "RECIPIENT-123"
                  amount:
                    type: number
                    description: "Amount allocated to the recipient."
                    example: 100.00
                  liable:
                    type: boolean
                    description: "Indicates if the recipient is liable for the payment."
                    example: true
                  charge_fee:
                    type: boolean
                    description: "Indicates if the recipient should bear the transaction fee."
                    example: true
        status:
          type: string
          description: "Overall status of the payment request."
          example: "SUCCESS"
        redirect_url:
          type: string
          description: "URL to redirect the user after successful payment."
          example: "https://example.com/redirect?hash=dummy_hash_123456"

    PSECORequest:
      type: object
      title: PSE Payment Request
      description: Request payload to initiate a PSE payment.
      properties:
        integration_key:
          type: string
          description: "Unique key for integration with the payment provider."
          example: "dummy_integration_key_67890"
        operation:
          type: string
          description: "Type of operation, e.g., 'request'."
          example: "request"
        payment:
          type: object
          description: "Payment details."
          properties:
            address:
              type: string
              description: "Street address of the payer."
              example: "456 Maple Avenue"
            amount_total:
              type: number
              description: "Total amount for the payment."
              example: 150000.00
            city:
              type: string
              description: "City of the payer's address."
              example: "Bogotá"
            country:
              type: string
              description: "Country code of the payer's address."
              example: "CO"
            currency_code:
              type: string
              description: "Currency code, e.g., 'COP'."
              example: "COP"
            eft_code:
              type: string
              description: "EFT payment method code, e.g., 'nequi'."
              example: "nequi"
            email:
              type: string
              description: "Email address of the payer."
              example: "jane.doe@example.com"
            items:
              type: array
              description: "List of items for the payment."
              items:
                type: object
                properties:
                  description:
                    type: string
                    description: "Description of the item."
                    example: "Product Description"
                  name:
                    type: string
                    description: "Name of the item."
                    example: "Product Name"
                  quantity:
                    type: integer
                    description: "Quantity of the item."
                    example: 1
                  sku:
                    type: string
                    description: "Stock Keeping Unit (SKU) for the item."
                    example: "SKU123456"
                  unit_price:
                    type: number
                    description: "Unit price of the item."
                    example: 150000.00
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "PAYMENT123456"
            name:
              type: string
              description: "Full name of the payer."
              example: "Jane Doe"
            order_number:
              type: string
              description: "Order number associated with the payment."
              example: "ORDER123456"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'eft'."
              example: "eft"
            phone_number:
              type: string
              description: "Phone number of the payer."
              example: "3001234567"
            redirect_url:
              type: string
              description: "URL to redirect the user after payment."
              example: "https://example.com/redirect"
            state:
              type: string
              description: "State of the payer's address."
              example: "Cundinamarca"
            street_number:
              type: string
              description: "Street number of the payer's address."
              example: "456"
            zipcode:
              type: string
              description: "ZIP code of the payer's address."
              example: "110111"

    PSECOResponse:
      type: object
      title: PSE Payment Response
      description: Response payload for a PSE payment request.
      properties:
        payment:
          type: object
          description: "Details of the processed payment."
          properties:
            hash:
              type: string
              description: "Unique identifier for the payment."
              example: "dummy_hash_789012"
            country:
              type: string
              description: "Country code of the payment."
              example: "co"
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "PAYMENT123456"
            order_number:
              type: string
              description: "Order number associated with the payment."
              example: "ORDER123456"
            status:
              type: string
              description: "Payment status, e.g., 'PE' (Pending)."
              example: "PE"
            status_date:
              type: string
              format: date-time
              description: "Date and time of the payment status."
              example: "2024-09-16T10:23:48Z"
            open_date:
              type: string
              format: date-time
              description: "Date and time when the payment was opened."
              example: "2024-09-16T10:23:48Z"
            confirm_date:
              type: string
              format: date-time
              description: "Date and time when the payment was confirmed."
              example: null
            transfer_date:
              type: string
              format: date-time
              description: "Date and time when the payment was transferred."
              example: null
            amount_br:
              type: string
              description: "Amount in the local currency (COP)."
              example: "150000.00"
            amount_ext:
              type: string
              description: "Amount in the external currency."
              example: "150000.00"
            amount_iof:
              type: string
              description: "Amount of IOF (tax) applied to the payment."
              example: "0.00"
            currency_rate:
              type: string
              description: "Currency exchange rate used."
              example: "1.0000"
            currency_ext:
              type: string
              description: "External currency code."
              example: "COP"
            due_date:
              type: string
              format: date
              description: "Due date for the payment."
              example: "2024-09-17"
            instalments:
              type: string
              description: "Number of payment instalments."
              example: "1"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'eft'."
              example: "eft"
            redirect_url:
              type: string
              description: "URL to redirect the user after successful payment."
              example: "https://example.com/redirect?hash=dummy_hash_789012"
            pre_approved:
              type: boolean
              description: "Indicates if the payment is pre-approved."
              example: false
            capture_available:
              type: string
              description: "Indicates if the payment can be captured."
              example: null
        status:
          type: string
          description: "Overall status of the payment request."
          example: "SUCCESS"
        redirect_url:
          type: string
          description: "URL to redirect the user after successful payment."
          example: "https://example.com/redirect?hash=dummy_hash_789012"

    OXXOMXRequest:
      type: object
      title: OXXO Payment Request
      description: Request payload to initiate an OXXO payment.
      properties:
        integration_key:
          type: string
          description: "Unique key for integration with the payment provider."
          example: "dummy_integration_key_54321"
        operation:
          type: string
          description: "Type of operation, e.g., 'request'."
          example: "request"
        mode:
          type: string
          description: "Mode of the request, e.g., 'full'."
          example: "full"
        payment:
          type: object
          description: "Payment details."
          properties:
            sub_account:
              type: object
              description: "Details of the sub-account associated with the payment."
              properties:
                name:
                  type: string
                  description: "Name of the sub-account."
                  example: "Sub Account Name"
                image_url:
                  type: string
                  description: "Image URL for the sub-account."
                  example: "https://example.com/image.jpg"
            name:
              type: string
              description: "Full name of the payer."
              example: "Alex Smith"
            email:
              type: string
              description: "Email address of the payer."
              example: "alex.smith@example.com"
            currency_code:
              type: string
              description: "Currency code, e.g., 'MXN'."
              example: "MXN"
            amount_total:
              type: number
              description: "Total amount for the payment."
              example: 5000.00
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "MERCHANT123456"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'oxxo'."
              example: "oxxo"
            customer_ip:
              type: string
              description: "IP address of the payer."
              example: "192.168.1.1"
            country:
              type: string
              description: "Country code of the payer's address."
              example: "MX"
            phone_number:
              type: string
              description: "Phone number of the payer."
              example: "5551234567"
            due_date:
              type: string
              format: date
              description: "Due date for the payment."
              example: "2024-09-19"
            create_token:
              type: boolean
              description: "Indicates if a payment token should be created."
              example: false
            instalments:
              type: integer
              description: "Number of payment instalments."
              example: 1
            device_id:
              type: string
              description: "Device ID used for the payment."
              example: "device12345"
            bypass_boleto_screen:
              type: boolean
              description: "Indicates if the boleto screen should be bypassed."
              example: false
            fx_token:
              type: string
              description: "Token for fraud prevention."
              example: "dummy_fx_token"

    OXXOMXResponse:
      type: object
      title: OXXO Payment Response
      description: Response payload for an OXXO payment request.
      properties:
        payment:
          type: object
          description: "Details of the processed payment."
          properties:
            hash:
              type: string
              description: "Unique identifier for the payment."
              example: "dummy_hash_654321"
            country:
              type: string
              description: "Country code of the payment."
              example: "mx"
            merchant_payment_code:
              type: string
              description: "Merchant's unique payment code."
              example: "MERCHANT123456"
            order_number:
              type: string
              description: "Order number associated with the payment."
              example: "ORDER654321"
            status:
              type: string
              description: "Payment status, e.g., 'PE' (Pending)."
              example: "PE"
            status_date:
              type: string
              format: date-time
              description: "Date and time of the payment status."
              example: "2024-09-16T10:19:16Z"
            open_date:
              type: string
              format: date-time
              description: "Date and time when the payment was opened."
              example: "2024-09-16T10:19:16Z"
            confirm_date:
              type: string
              format: date-time
              description: "Date and time when the payment was confirmed."
              example: null
            transfer_date:
              type: string
              format: date-time
              description: "Date and time when the payment was transferred."
              example: null
            amount_br:
              type: string
              description: "Amount in the local currency (MXN)."
              example: "5000.00"
            amount_ext:
              type: string
              description: "Amount in the external currency."
              example: "5000.00"
            amount_iof:
              type: string
              description: "Amount of IOF (tax) applied to the payment."
              example: "0.00"
            currency_rate:
              type: string
              description: "Currency exchange rate used."
              example: "1.0000"
            currency_ext:
              type: string
              description: "External currency code."
              example: "MXN"
            due_date:
              type: string
              format: date
              description: "Due date for the payment."
              example: "2024-09-19"
            instalments:
              type: string
              description: "Number of payment instalments."
              example: "1"
            payment_type_code:
              type: string
              description: "Payment method code, e.g., 'oxxo'."
              example: "oxxo"
            oxxo_url:
              type: string
              description: "URL to print the OXXO payment slip."
              example: "https://example.com/oxxo/print?hash=dummy_hash_654321"
            oxxo_barcode:
              type: string
              description: "Barcode for the OXXO payment slip."
              example: "29000000000123456789012345678901"
            pre_approved:
              type: boolean
              description: "Indicates if the payment is pre-approved."
              example: false
            capture_available:
              type: string
              description: "Indicates if the payment can be captured."
              example: null
        status:
          type: string
          description: "Overall status of the payment request."
          example: "SUCCESS"

    ErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            status:
              type: string
              example: 'ERROR'
              description: ERROR
            status_code:
              type: string
              example: 'BP-DR-23'
              description: Code of error.
            status_message:
              type: string
              example: 'Field payment.document must be a valid CPF'
              description: Message about error.
          required:
            - status
            - status_code
            - status_message